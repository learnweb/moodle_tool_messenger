{"version":3,"sources":["../src/popup.js"],"names":["define","$","modalfactory","url","ajax","modalevents","get_next_modal","data","index","length","localdata","create","type","types","ALERT","title","header","body","message","then","modal","root","getRoot","on","cancel","call","methodname","args","lastpopupid","id","show","init","done","response","JSON","parse","fail","ex","window","console","log"],"mappings":"AAAAA,OAAM,wBAAC,CAAC,QAAD,CAAW,oBAAX,CAAiC,UAAjC,CAA6C,WAA7C,CAA0D,mBAA1D,CAAD,CAAiF,SAAUC,CAAV,CAAaC,CAAb,CAA2BC,CAA3B,CAAgCC,CAAhC,CAAsCC,CAAtC,CAAmD,IAElIC,CAAAA,CAAc,CAAG,SAAUC,CAAV,CAAgBC,CAAhB,CAAuB,CACxC,GAAID,CAAI,CAACE,MAAL,EAAeD,CAAnB,CAA0B,CACtB,MACH,CACD,GAAIE,CAAAA,CAAS,CAAGH,CAAI,CAACC,CAAD,CAApB,CACAN,CAAY,CAACS,MAAb,CAAoB,CAChBC,IAAI,CAAEV,CAAY,CAACW,KAAb,CAAmBC,KADT,CAEhBC,KAAK,CAAEL,CAAS,CAACM,MAFD,CAGhBC,IAAI,CAAEP,CAAS,CAACQ,OAHA,CAApB,EAIGC,IAJH,CAIQ,SAAUC,CAAV,CAAiB,CACrB,GAAIC,CAAAA,CAAI,CAAGD,CAAK,CAACE,OAAN,EAAX,CACAD,CAAI,CAACE,EAAL,CAAQlB,CAAW,CAACmB,MAApB,CAA4B,UAAY,CACpCpB,CAAI,CAACqB,IAAL,CAAU,CACN,CAACC,UAAU,CAAE,yCAAb,CAAwDC,IAAI,CAAE,CAACC,WAAW,CAAElB,CAAS,CAACmB,EAAxB,CAA9D,CADM,CAAV,EAGAvB,CAAc,CAACC,CAAD,CAAOC,CAAK,CAAG,CAAf,CACjB,CALD,EAMAY,CAAK,CAACU,IAAN,EACH,CAbD,CAcH,CArBqI,CAoCtI,MAAO,CACHC,IAAI,CAdG,QAAPA,CAAAA,IAAO,EAAY,CAEnB3B,CAAI,CAACqB,IAAL,CAAU,CACN,CAACC,UAAU,CAAE,oCAAb,CAAmDC,IAAI,CAF9C,EAET,CADM,CAAV,EAEG,CAFH,EAEMK,IAFN,CAEW,SAAUC,CAAV,CAAoB,CAC3B,GAAI1B,CAAAA,CAAI,CAAG2B,IAAI,CAACC,KAAL,CAAWF,CAAX,CAAX,CACA3B,CAAc,CAACC,CAAD,CAAO,CAAP,CACjB,CALD,EAKG6B,IALH,CAKQ,SAAUC,CAAV,CAAc,CAClBC,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,uCAAnB,EACAF,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmBH,CAAnB,CACH,CARD,CASH,CAEM,CAGV,CAvCK,CAAN","sourcesContent":["define(['jquery', 'core/modal_factory', 'core/url', 'core/ajax', 'core/modal_events'], function ($, modalfactory, url, ajax, modalevents) {\n\n    var get_next_modal = function (data, index) {\n        if (data.length <= index) {\n            return;\n        }\n        var localdata = data[index];\n        modalfactory.create({\n            type: modalfactory.types.ALERT,\n            title: localdata.header,\n            body: localdata.message\n        }).then(function (modal) {\n            var root = modal.getRoot();\n            root.on(modalevents.cancel, function () {\n                ajax.call([\n                    {methodname: 'tool_messenger_set_lastpopupid_for_user', args: {lastpopupid: localdata.id}}\n                ]);\n                get_next_modal(data, index + 1);\n            });\n            modal.show();\n        });\n    };\n\n    var init = function () {\n        var params = {};\n        ajax.call([\n            {methodname: 'tool_messenger_get_popups_for_user', args: params}\n        ])[0].done(function (response) {\n            var data = JSON.parse(response);\n            get_next_modal(data, 0);\n        }).fail(function (ex) {\n            window.console.log('Getting popups for this user failed: ');\n            window.console.log(ex);\n        });\n    };\n\n    return {\n        init: init\n    };\n});\n"],"file":"popup.min.js"}